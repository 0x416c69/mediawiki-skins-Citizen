//
// Citizen - Searchbox styles
// https://starcitizen.tools
//

#search {
	&form {
		position: absolute;
		z-index: -1; // not interactable
		margin: 7px 0 8px; // 1px h3 screen reader
		display: flex;
		top: 0;
		right: @margin-side / 2;
		opacity: 0;
		.boxshadow(4);
		transition: @transition-opacity;
		pointer-events: none; // not clickable

		&-icon {
			position: absolute;
			margin-left: @search-bar-icon-size;
			width: @search-bar-icon-size;
			height: @search-bar-height;
			opacity: @opacity-icon;
			background-size: contain;
    		background-repeat: no-repeat;
    		background-position: center;
		}
	}

	&-toggle {
		right: 0; // align checkbox with icon
		z-index: 21; // override to be on top of the form

		&-icon {
			position: relative;
			z-index: 20; // stay on top of search form
			display: flex;
			align-items: center;
			justify-content: center;
			width: @icon-box-size + @margin-side + @icon-padding;
			height: @header-height;
			opacity: @opacity-icon;
			transition: @transition-transform-quick, @transition-height-quick, @transition-opacity-quick, @transition-border-color-quick;

			&-1 {
				top: 7px;
				left: 12px;
				height: 10px;
				transform: rotate( -45deg );
			}

			&-2 {
				margin-top: -2px;
				margin-left: -2px;
				width: 10px;
				height: 10px;
				border: solid 2px @base-0;
				border-radius: 100%;
				transform: rotate( -45deg );
			}

			&-3 {
				opacity: 0;
				top: 0;
				left: -7px;
				height: 14px;
				transform: rotate( -135deg );
			}

			&-1,
			&-3 {
				width: 2px;
				background-color: @base-0;
			}
		}

		&:checked {
			~ #searchform {
				z-index: 10;
				opacity: 1;
				pointer-events: auto; // clickable

				#searchInput {
					width: @search-bar-width;
				}
			}

			~ #search-toggle-icon {
				#search-toggle-icon {
					&-2 {
						border-color: transparent;
					}

					&-1 {
						height: 14px;
						transform: translate( -5px, -7px ) rotate( 135deg );
					}

					&-3 {
						opacity: 1;
					}
				}

				&:hover {
					border-color: @base-0;

					#search-toggle-icon-3 {
						opacity: 0;
					}
				}
			}

			&:hover {
				~ #search-toggle-icon {
					#search-toggle-icon {
						&-1 {
							height: 12px;
							transform: translate( -5px, -7px ) rotate( 135deg );
						}

						&-2 {
							border-color: transparent;
						}

						&-3 {
							height: 12px;
						}
					}
				}
			}
		}

		&:hover {
			~ #search-toggle-icon {
				opacity: @opacity-icon-active;

				#search-toggle-icon {
					&-1 {
						height: 6px;
						transform: translate( 2px, 2px ) rotate( -45deg );
					}
				}
			}
		}
	}

	&Input {
		-webkit-appearance: none;
		-moz-appearance: none;
		appearance: none;
		padding: 12px @icon-box-size + @icon-padding 12px @search-bar-icon-size * 3;
		padding-right:  @icon-box-size + @icon-padding;
		width: 0;
		height: @search-bar-height;
		max-width: calc( ~'100vw -'@margin-side );
		border: 1px solid @base-90;
		transition: @transition-width, @transition-box-shadow;

		&:focus {
			outline: 0;
			.boxshadow(5);
		}
	}
}

.search {
	&-toggle-icon-div {
		position: relative;
		transition: inherit;
	}
}

@media ( prefers-color-scheme: dark ) {
	#search {
		&form {
			&-icon {
				opacity: 0.4;
				filter: invert(1);
			}
		}

		&-toggle {
			&-icon {
				opacity: 0.4;

				&-2 {
					border-color: @base-100;
				}

				&-1,
				&-3 {
					background: @base-100;
				}
			}

			&:hover {
				~ #search-toggle-icon {
					opacity: 0.6;
				}
			}
		}

		&Input {
			border-color: @dark-bg-60;
			background: @dark-bg-50 !important;
		}
	}
}
